<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Smartdown Grid Layout (using vue-grid-layout) </title>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">

    <link rel="stylesheet" href="vuegridlayout.css">
    <link rel="stylesheet" href="https://unpkg.com/smartdown/docs/lib/smartdown.css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <script src="https://unpkg.com/js-yaml/dist/js-yaml.min.js"></script>
    <script src="https://unpkg.com/vue/dist/vue.js"></script>

    <script src="https://unpkg.com/vue-grid-layout/dist/vue-grid-layout.min.js"></script>
    <script src="https://smartdown.site/lib/smartdown.js"></script>
  </head>

  <body
    class="container container-fluid"
    id="bodyID">
      <div
        v-cloak
        v-bind:class="{ 'disable-select': isDragging() }"
        id="layoutApp">

        <div
          class="layoutJSON">
          <div class="row">
            <div class="col-xs-9">
              <button
                v-for="t in tableaux"
                class="btn btn-default btn-xs tableau-button"
                v-bind:class="{ current: isCurrentTableau(t) }"
                v-on:click="loadTableau(t)">
                {{t}}
              </button>
            </div>
            <div class="col-xs-3" v-if="!kioskMode">
              <input type="checkbox" v-model="showSettings"/>&nbsp;Settings
            </div>
            <div class="col-xs-9" v-if="kioskMode">
              <button
                v-for="item in layout"
                class="btn btn-default btn-xs card-button"
                v-bind:class="{ focused: isSdTileInFocus(item.contentURL.split('/')[1]) }"
                v-on:click="focusOnCard(item.contentURL.split('/')[1])">
                {{item.contentURL.split('/')[1]}}
              </button>
            </div>
          </div>
          <div class="row" v-if="showSettings">
            <div class="col-xs-4">
              <div class="layoutItem" v-for="item in layout">
                  <b>{{item.i}}</b>: [{{item.x}}, {{item.y}}, {{item.w}}, {{item.h}}]
              </div>
            </div>
            <div class="col-xs-8">
              <div class="row">
                <div class="col-xs-12" v-if="authorMode">
                  <input
                    type="file"
                    id="sdSelection"
                    accept=".md"
                    v-on:change="updateSdSelection"
                    multiple/>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12">
                  <button class="btn btn-default btn-xs" v-on:click="switchToColumnLayout">Column Layout</button>
                  <button class="btn btn-default btn-xs" v-on:click="switchToRowLayout">Row Layout</button>
                  <button class="btn btn-default btn-xs" v-on:click="exportTableau">Export Tableau</button>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-8">
                  <input type="checkbox" v-model="draggable"/> Draggable
                  <input type="checkbox" v-model="resizable"/> Resizable
                </div>

                <div class="col-xs-4">
                  <button class="btn btn-default btn-xs" v-on:click="fixLayout">Fix</button>
                </div>

              </div>


            </div>
          </div>
        </div>

        <div id="content" class="smartdown-container">
          <grid-layout  ref="layout"
                        :layout="layout"
                        :col-num="numCols"
                        :row-height="rowHeight"
                        :margin="[3, 3]"
                        :is-draggable="draggable"
                        :is-resizable="resizable"
                        :vertical-compact="true"
                        :use-css-transforms="true">
            <grid-item  v-for="item in layout" :key="item.i"
                        :x="item.x"
                        :y="item.y"
                        :w="item.w"
                        :h="item.h"
                        :i="item.i"
                        @resize="resizeEvent"
                        @resized="resizedEvent"
                        drag-allow-from=".vue-draggable-handle"
                        drag-ignore-from=".no-drag">

              <div
                v-if="draggable"
                class="vue-draggable-handle"
                v-on:click="dragStart">
              </div>
              <div
                class="no-drag smartdown-tile"
                v-bind:id="item.divID"
                v-bind:class="{ 'in-focus': isSdTileInFocus(item.contentURL.split('/')[1]) }">
              </div>
            </grid-item>
          </grid-layout>
      </div>
    </div>

    <script>
      //
      // The options below control how the grid_helper behaves.
      // They are designed to support publishing via bl.ocks.org, a blog, or Wordpress
      //
      //  kioskMode - 'true' means disable the Settings checkbox
      //  tableaux - A list of names of tableaux in the tableaux/ directory
      //  defaultTableauName - The tableau to load by default. Default is tableaux[0]
      //
      window.gridHelperOptions = {
        kioskMode: true,
        authorMode: false,
        tableaux: ['Comic', 'Welcome'],
        defaultTableauName: 'Comic',
      };
    </script>
    <script src="grid_helper.js"></script>
  </body>
</html>
